-- LocalScript in StarterPlayerScripts

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local LOCAL_PLAYER = Players.LocalPlayer
local TARGET_NAME = "TargetPlayerName" -- üßç CHANGE THIS to your target's username
local SOUND_NAME = "MusicSound"

-- Wait for target player and their character
local targetPlayer = Players.maddoxalt_3
local character = targetPlayer.Character or targetPlayer.CharacterAdded:Wait()
local hrp = character.HumanoidRootPart

-- Get or create the music sound
local sound = game["Run Service"].danc

-- Create the visualizer part
local part = Instance.new("Part")
part.Name = "VisualizerPart"
part.Anchored = true
part.CanCollide = false
part.Transparency = 0
part.Size = Vector3.new(1, 0.1, 1)
part.Material = Enum.Material.Neon
part.BrickColor = BrickColor.new("Really black")
part.Parent = Workspace

-- Add mesh to make it a flat circle
local mesh = Instance.new("SpecialMesh")
mesh.MeshType = Enum.MeshType.Sphere -- Use FileMesh if you want a ring
mesh.Scale = Vector3.new(1, 0.01, 1) -- FLAT circle
mesh.Parent = part

-- CONFIG
local HEIGHT_OFFSET = -3 -- how far under the character
local MIN_SCALE = 1
local MAX_SCALE = 15
local MAX_LOUDNESS = 1000
local SMOOTH_SPEED = 60

-- Smoothing variable
local currentScale = MIN_SCALE

-- MAIN LOOP
RunService.RenderStepped:Connect(function(dt)
	if not hrp or not hrp.Parent then return end

	-- Follow the target's position (under the HumanoidRootPart)
	local basePos = hrp.Position + Vector3.new(0, HEIGHT_OFFSET, 0)
	part.Position = basePos

	-- PlaybackLoudness controls size
	local loud = sound.PlaybackLoudness
	local factor = math.clamp(loud / MAX_LOUDNESS, 0, 1)
	local targetScale = MIN_SCALE + (MAX_SCALE - MIN_SCALE) * factor
	currentScale = currentScale + (targetScale - currentScale) * math.clamp(SMOOTH_SPEED * dt, 0, 1)

	mesh.Scale = Vector3.new(currentScale, 0.01, currentScale)
end)
